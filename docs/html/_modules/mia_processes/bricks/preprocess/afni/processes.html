
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mia_processes.bricks.preprocess.afni.processes &#8212; mia_processes 2.2.1-dev+bccf669 documentation</title>
    <link rel="stylesheet" href="../../../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../../../../index.html">
          <span>mia_processes 2.2.1-dev+bccf669 documentation</span></a></h1>
        <h2 class="heading"><span>mia_processes.bricks.preprocess.afni.processes</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../../../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <h1>Source code for mia_processes.bricks.preprocess.afni.processes</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;The afni preprocess library of the mia_processes package.</span>

<span class="sd">The purpose of this module is to customise the main afni preprocessing bricks</span>
<span class="sd">provided by nipype and to correct some things that do not work directly in</span>
<span class="sd">populse_mia.</span>

<span class="sd">:Contains:</span>
<span class="sd">    :Class:</span>
<span class="sd">        - Automask</span>
<span class="sd">        - Calc</span>
<span class="sd">        - CalcDropTRs</span>
<span class="sd">        - Despike</span>
<span class="sd">        - FWHMx</span>
<span class="sd">        - GCOR</span>
<span class="sd">        - OutlierCount</span>
<span class="sd">        - QualityIndex</span>
<span class="sd">        - RefitDeoblique</span>
<span class="sd">        - SkullStrip</span>
<span class="sd">        - TShift</span>
<span class="sd">        - TStatMean</span>
<span class="sd">        - Volreg</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">##########################################################################</span>
<span class="c1"># mia_processes - Copyright (C) IRMaGe/CEA, 2018</span>
<span class="c1"># Distributed under the terms of the CeCILL license, as published by</span>
<span class="c1"># the CEA-CNRS-INRIA. Refer to the LICENSE file or to</span>
<span class="c1"># http://www.cecill.info/licences/Licence_CeCILL_V2.1-en.html</span>
<span class="c1"># for details.</span>
<span class="c1">##########################################################################</span>

<span class="c1"># Other import</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>

<span class="c1"># nipype imports</span>
<span class="kn">from</span> <span class="nn">nipype.interfaces.base</span> <span class="kn">import</span> <span class="n">File</span>

<span class="c1"># populse_mia import</span>
<span class="kn">from</span> <span class="nn">populse_mia.user_interface.pipeline_manager.process_mia</span> <span class="kn">import</span> <span class="n">ProcessMIA</span>
<span class="kn">from</span> <span class="nn">traits.api</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Bool</span><span class="p">,</span>
    <span class="n">Either</span><span class="p">,</span>
    <span class="n">Enum</span><span class="p">,</span>
    <span class="n">Float</span><span class="p">,</span>
    <span class="n">Int</span><span class="p">,</span>
    <span class="n">List</span><span class="p">,</span>
    <span class="n">String</span><span class="p">,</span>
    <span class="n">Tuple</span><span class="p">,</span>
    <span class="n">Undefined</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">mia_processes.utils</span> <span class="kn">import</span> <span class="n">checkFileExt</span>

<span class="n">EXT</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">:</span> <span class="s2">&quot;nii.gz&quot;</span><span class="p">,</span> <span class="s2">&quot;NIFTI&quot;</span><span class="p">:</span> <span class="s2">&quot;nii&quot;</span><span class="p">}</span>


<div class="viewcode-block" id="Automask"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Automask">[docs]</a><span class="k">class</span> <span class="nc">Automask</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * Create a brain-only mask of the image using AFNI 3dAutomask command.</span>

<span class="sd">    Please, see the complete documentation for the `Automask&#39; brick in</span>
<span class="sd">    the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/Automask.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Automask.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Automask.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Automask</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Mandatory inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Input file (a pathlike object or string &quot;</span> <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Optional inputs with default value description</span>
        <span class="n">clfrac_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Sets the clip level fraction (must be 0.1-0.9).&quot;</span>
            <span class="s2">&quot;A small value will tend to make the mask larger &quot;</span>
            <span class="s2">&quot;(a float)&quot;</span>
        <span class="p">)</span>
        <span class="n">out_brain_suffix_desc</span> <span class="o">=</span> <span class="s2">&quot;Suffix of the brain masked image (a string)&quot;</span>
        <span class="n">output_type_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Typecodes of the output image formats (one &quot;</span>
            <span class="s2">&quot;of NIFTI, NIFTI_GZ).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the output image file &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Optional inputs description</span>
        <span class="n">dilate_desc</span> <span class="o">=</span> <span class="s2">&quot;Dilate the mask outwards (an integer)&quot;</span>
        <span class="n">erode_desc</span> <span class="o">=</span> <span class="s2">&quot;Erode the mask inwards (an integer)&quot;</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The brain mask file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="n">brain_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The masked brain file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Mandatory inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Optional inputs with default value traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;clfrac&quot;</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">clfrac_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_brain_suffix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span>
                <span class="s2">&quot;_masked&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">out_brain_suffix_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;NIFTI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">output_type_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span>
                <span class="s2">&quot;automask_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Optional inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;erode&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">erode_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;dilate&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">dilate_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;brain_file&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">brain_file_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.Automask&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Automask.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Automask.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Automask</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;automask_&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_prefix parameter is undefined. Automatically &quot;</span>
                    <span class="s1">&#39;set to &quot;automask&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_brain_suffix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_brain_suffix</span> <span class="o">=</span> <span class="s2">&quot;_masked&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_brain_suffix parameter is undefined.&quot;</span>
                    <span class="s1">&#39;Automatically set to &quot;_masked&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is not recognized ...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                        <span class="o">+</span> <span class="n">fileName</span>
                        <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                        <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;brain_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                        <span class="n">fileName</span>
                        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_brain_suffix</span>
                        <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                        <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;brain_file&quot;</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="Automask.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Automask.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Automask</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outputtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">brain_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">brain_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">clfrac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clfrac</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">erode</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">erode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">erode</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dilate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">dilate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dilate</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="Calc"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Calc">[docs]</a><span class="k">class</span> <span class="nc">Calc</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * Voxel-by-voxel arithmetic on 3D datasets.</span>

<span class="sd">    Please, see the complete documentation for the `Calc&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/Calc.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Calc.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Calc.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Calc</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_a_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;First input 3D file (a pathlike object or string &quot;</span>
            <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">in_file_b_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Second input 3D file (a pathlike object or string &quot;</span>
            <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">in_file_c_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Third input 3D file (a pathlike object or string &quot;</span>
            <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">expr_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Arithmetic expression to apply between a, b and c &quot;</span> <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>
        <span class="n">output_type_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Typecodes of the output image formats (one &quot;</span>
            <span class="s2">&quot;of NIFTI, NIFTI_GZ).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the output image file &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>
        <span class="n">single_idx_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Volume index for in_file_a.&quot;</span> <span class="s2">&quot;(an integer or Undefined)&quot;</span>
        <span class="p">)</span>
        <span class="n">start_idx_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Start index for in_file_a (an integer&quot;</span>
            <span class="s2">&quot;or Undefined). Requires inputs: stop_idx&quot;</span>
        <span class="p">)</span>
        <span class="n">stop_idx_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Stop index for in_file_a (an integer or Undefined).&quot;</span>
            <span class="s2">&quot;Requires inputs: start_idx.&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The calculated files (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file_a&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_a_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file_b&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span>
                <span class="n">value</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">in_file_b_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file_c&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span>
                <span class="n">value</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">in_file_c_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Optional inputs with default value traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;expr&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span><span class="n">Undefined</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">expr_desc</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expr</span> <span class="o">=</span> <span class="s2">&quot;a*step(b)&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;NIFTI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">output_type_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span><span class="s2">&quot;c_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Optional inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;single_idx&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">single_idx_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;start_idx&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">start_idx_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;stop_idx&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">stop_idx_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.Calc&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Calc.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Calc.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Calc</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_idx</span> <span class="o">!=</span> <span class="n">Undefined</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_idx</span> <span class="o">==</span> <span class="n">Undefined</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">!=</span> <span class="n">Undefined</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Initialisation failed. &quot;start_idx&quot; parameter required&#39;</span>
                <span class="s1">&#39;&quot;stop_idx&quot; parameters and vice versa&#39;</span>
            <span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file_a</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;c_&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_prefix parameter is undefined. Automatically &quot;</span>
                    <span class="s1">&#39;set to &quot;c&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName_a</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">in_file_a</span><span class="p">,</span> <span class="n">EXT</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is not recognized ...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                        <span class="o">+</span> <span class="n">fileName_a</span>
                        <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                        <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file_a</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="Calc.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Calc.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Calc</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file_a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file_b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outputtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">single_idx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">single_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">single_idx</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_idx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">start_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_idx</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="CalcDropTRs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.CalcDropTRs">[docs]</a><span class="k">class</span> <span class="nc">CalcDropTRs</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * DropTRs of bold datasets (using AFNI 3dCalc command).</span>

<span class="sd">    Please, see the complete documentation for the `CalcDropTRs&#39; brick in</span>
<span class="sd">    the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/CalcDropTRs.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CalcDropTRs.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.CalcDropTRs.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CalcDropTRs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Input 3D file (a pathlike object or string &quot;</span>
            <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">output_type_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Typecodes of the output image formats (one &quot;</span>
            <span class="s2">&quot;of NIFTI, NIFTI_GZ).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the output image file &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>
        <span class="n">start_idx_desc</span> <span class="o">=</span> <span class="s2">&quot;start index (inclusive) for in_file (an Int).&quot;</span>
        <span class="n">stop_idx_desc</span> <span class="o">=</span> <span class="s2">&quot;stop index (exclusive) for in_file (an Int).&quot;</span>
        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The TR cropped file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Mandatory inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Optional inputs with default value traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;NIFTI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">output_type_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span>
                <span class="s2">&quot;cropped_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;start_idx&quot;</span><span class="p">,</span>
            <span class="n">Int</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">start_idx_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;stop_idx&quot;</span><span class="p">,</span>
            <span class="n">Int</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">stop_idx_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.Calc&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CalcDropTRs.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.CalcDropTRs.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CalcDropTRs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Warning: stop_idx will be automatically set to&quot;</span>
                    <span class="s2">&quot;the length of input file&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_idx</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error: stop_idx cannot be lower than or equal to&quot;</span>
                    <span class="s2">&quot;start_idx&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_idx</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;cropped_&quot;</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;The out_prefix parameter is undefined.&quot;</span>
                        <span class="s1">&#39;Automatically set to &quot;cropped&quot; ...&#39;</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                    <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is&quot;</span> <span class="s2">&quot; not recognized...!&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                            <span class="o">+</span> <span class="n">fileName</span>
                            <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                            <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="CalcDropTRs.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.CalcDropTRs.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CalcDropTRs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">imnii</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">)</span>
            <span class="n">nb_volumes</span> <span class="o">=</span> <span class="n">imnii</span><span class="o">.</span><span class="n">dataobj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

        <span class="k">except</span> <span class="p">(</span>
            <span class="n">nib</span><span class="o">.</span><span class="n">filebasedimages</span><span class="o">.</span><span class="n">ImageFileError</span><span class="p">,</span>
            <span class="ne">FileNotFoundError</span><span class="p">,</span>
            <span class="ne">TypeError</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error while opening input file&quot;</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">expr</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outputtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">start_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_idx</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">=</span> <span class="n">nb_volumes</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">stop_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="Despike"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Despike">[docs]</a><span class="k">class</span> <span class="nc">Despike</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * Removes ‘spikes’ from the 3D+time input dataset.</span>

<span class="sd">    Please, see the complete documentation for the `Despike&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/Despike.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Despike.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Despike.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Despike</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Input 3D file (a pathlike object or string &quot;</span>
            <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">despike_desc</span> <span class="o">=</span> <span class="s2">&quot;Despike dataset only if true (boolean).&quot;</span>
        <span class="n">output_type_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Typecodes of the output image formats (one &quot;</span>
            <span class="s2">&quot;of NIFTI, NIFTI_GZ).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the output image file &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The despiked file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;despike&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">despike_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;NIFTI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">output_type_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span><span class="s2">&quot;d_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.Despike&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Despike.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Despike.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Despike</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">despike</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;d_&quot;</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;The out_prefix parameter is undefined.&quot;</span>
                        <span class="s1">&#39;Automatically set to &quot;d&quot; ...&#39;</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                    <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is&quot;</span> <span class="s2">&quot; not recognized...!&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                            <span class="o">+</span> <span class="n">fileName</span>
                            <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                            <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                        <span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="Despike.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Despike.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Despike</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">despike</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outputtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="FWHMx"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.FWHMx">[docs]</a><span class="k">class</span> <span class="nc">FWHMx</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * | Computes FWHMs for all sub-bricks in the input dataset,</span>
<span class="sd">      | each one separately.</span>

<span class="sd">    Please, see the complete documentation for the `FWHMx&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/reports/FWHMx.html&gt;`_</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FWHMx.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.FWHMx.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FWHMx</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Input image (a pathlike object or string &quot;</span> <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">mask_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Mask image (a pathlike object or string &quot;</span> <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">combine_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Combine the final measurements along each axis (a bool).&quot;</span>
        <span class="p">)</span>
        <span class="n">detrend_desc</span> <span class="o">=</span> <span class="s2">&quot;Detrend to the specified order (a bool or an int).&quot;</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the output image file &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>
        <span class="n">args_desc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The output file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;mask_file&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span><span class="n">Undefined</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">mask_file_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;combine&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">combine_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;detrend&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Bool</span><span class="p">(),</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">detrend_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span><span class="s2">&quot;fwhm_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">args_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.FWHMx&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FWHMx.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.FWHMx.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FWHMx</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;fwhm_&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_prefix parameter is undefined. Automatically &quot;</span>
                    <span class="s1">&#39;set to &quot;fwhm&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is not recognized ...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">+</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s2">&quot;.out&quot;</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="FWHMx.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.FWHMx.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FWHMx</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">combine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">detrend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detrend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="GCOR"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.GCOR">[docs]</a><span class="k">class</span> <span class="nc">GCOR</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * | Computes the average correlation between every voxel and ever other</span>
<span class="sd">      | voxel, over any give mask.</span>

<span class="sd">    Please, see the complete documentation for the `GCOR&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/reports/GCOR.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="GCOR.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.GCOR.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GCOR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Input image (a pathlike object or string &quot;</span> <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">mask_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Mask image (a pathlike object or string &quot;</span> <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">nfirst_desc</span> <span class="o">=</span> <span class="s2">&quot;Specify number of initial TRs to ignore&quot;</span>
        <span class="n">no_demean_desc</span> <span class="o">=</span> <span class="s2">&quot;Do not (need to) demean as first step.&quot;</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_desc</span> <span class="o">=</span> <span class="s2">&quot;Global correlation value (a float).&quot;</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;mask_file&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span><span class="n">Undefined</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">mask_file_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;nfirst&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">nfirst_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;no_demean&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">no_demean_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out&quot;</span><span class="p">,</span>
            <span class="n">Float</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nipype_process_name</span><span class="o">=</span><span class="s2">&quot;_out&quot;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.GCOR&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GCOR.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.GCOR.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GCOR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is not recognized ...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="GCOR.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.GCOR.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GCOR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">nfirst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfirst</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">no_demean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_demean</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="OutlierCount"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.OutlierCount">[docs]</a><span class="k">class</span> <span class="nc">OutlierCount</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * | Computes outliers for all sub-bricks in the input dataset,</span>
<span class="sd">      | each one separately.</span>

<span class="sd">    Please, see the complete documentation for the `OutlierCount&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/reports/OutlierCount.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="OutlierCount.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.OutlierCount.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OutlierCount</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Input image (a pathlike object or string &quot;</span> <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">automask_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Clip off small voxels (a boolean). &quot;</span>
            <span class="s2">&quot;Mutually exclusive with mask&quot;</span>
        <span class="p">)</span>
        <span class="n">autoclip_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Clip off small voxels (a boolean). &quot;</span>
            <span class="s2">&quot;Mutually exclusive with mask&quot;</span>
        <span class="p">)</span>
        <span class="n">interval_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Write out the median + 3.5 MAD of outlier &quot;</span>
            <span class="s2">&quot;count with each timepoint. &quot;</span>
        <span class="p">)</span>
        <span class="n">mask_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Mask image. Compute correlation only across &quot;</span>
            <span class="s2">&quot;masked voxels.(a pathlike object or string &quot;</span>
            <span class="s2">&quot;representing a file). Mutually exclusive &quot;</span>
            <span class="s2">&quot;with automask and autoclip&quot;</span>
        <span class="p">)</span>
        <span class="n">fraction_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Combine the final measurements &quot;</span> <span class="s2">&quot;along each axis (a bool).&quot;</span>
        <span class="p">)</span>
        <span class="n">interval_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Write out the median + 3.5 MAD of outlier &quot;</span>
            <span class="s2">&quot;count with each timepoint.&quot;</span>
        <span class="p">)</span>
        <span class="n">legendre_desc</span> <span class="o">=</span> <span class="s2">&quot;Use Legendre polynomials.&quot;</span>
        <span class="n">polort_desc</span> <span class="o">=</span> <span class="s2">&quot;Detrend each voxel timeseries with polynomials. &quot;</span>
        <span class="n">qthr_desc</span> <span class="o">=</span> <span class="s2">&quot;Indicate a value for q to compute alpha.&quot;</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the output image file &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The output text file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;mask_file&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span><span class="n">Undefined</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">mask_file_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;autoclip&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">autoclip_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;automask&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">automask_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;fraction&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">fraction_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">interval_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;legendre&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">legendre_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span>
                <span class="s2">&quot;outliers_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;polort&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">polort_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;qthr&quot;</span><span class="p">,</span>
            <span class="n">Int</span><span class="p">(</span>
                <span class="mf">0.001</span><span class="p">,</span>
                <span class="nb">min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">qthr_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.OutlierCount&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="OutlierCount.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.OutlierCount.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OutlierCount</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automask</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">autoclip</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;Initisalisation failed..&quot;</span>
                    <span class="s2">&quot;Automask and mask_file parameters are &quot;</span>
                    <span class="s2">&quot;mutually esclusive&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;outliers_&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_prefix parameter is undefined. Automatically &quot;</span>
                    <span class="s1">&#39;set to &quot;outliers&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is not recognized ...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">+</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s2">&quot;.out&quot;</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="OutlierCount.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.OutlierCount.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OutlierCount</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">automask</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">automask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">automask</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoclip</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">autoclip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoclip</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">autoclip</span> <span class="o">=</span> <span class="n">Undefined</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">automask</span> <span class="o">=</span> <span class="n">Undefined</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">legendre</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">legendre</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">polort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polort</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">qthr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qthr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="QualityIndex"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.QualityIndex">[docs]</a><span class="k">class</span> <span class="nc">QualityIndex</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * | Computes a quality index for each sub-brick in a 3D+time dataset.</span>
<span class="sd">      | The output is a 1D time series with the index for each sub-brick.</span>

<span class="sd">    Please, see the complete documentation for the `QualityIndex&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/reports/QualityIndex.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="QualityIndex.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.QualityIndex.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QualityIndex</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;A bold file (a pathlike object or string &quot;</span> <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">automask_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Clip off small voxels (a boolean). &quot;</span>
            <span class="s2">&quot;Mutually exclusive with mask&quot;</span>
        <span class="p">)</span>
        <span class="n">autoclip_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Clip off small voxels (a boolean). &quot;</span>
            <span class="s2">&quot;Mutually exclusive with mask&quot;</span>
        <span class="p">)</span>
        <span class="n">interval_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Write out the median + 3.5 MAD of outlier &quot;</span>
            <span class="s2">&quot;count with each timepoint. &quot;</span>
        <span class="p">)</span>
        <span class="n">mask_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Mask image. Compute correlation only across &quot;</span>
            <span class="s2">&quot;masked voxels.(a pathlike object or string &quot;</span>
            <span class="s2">&quot;representing a file). Mutually exclusive &quot;</span>
            <span class="s2">&quot;with automask and autoclip&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the output image file &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>
        <span class="n">quadrant_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Similar to -spearman, but using 1 minus &quot;</span>
            <span class="s2">&quot;the quadrant correlation coefficient as &quot;</span>
            <span class="s2">&quot;the quality index&quot;</span>
        <span class="p">)</span>
        <span class="n">spearman_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Quality index is 1 minus the Spearman (rank) &quot;</span>
            <span class="s2">&quot;correlation coefficient of each sub-brick with &quot;</span>
            <span class="s2">&quot;the median sub-brick. &quot;</span>
        <span class="p">)</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The output file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;automask&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">automask_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;autoclip&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">autoclip_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">interval_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;mask_file&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span><span class="n">Undefined</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">mask_file_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span><span class="s2">&quot;QI_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;quadrant&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">quadrant_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;spearman&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">spearman_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.QualityIndex&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="QualityIndex.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.QualityIndex.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QualityIndex</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automask</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">autoclip</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Initisalisation failed..&quot;</span>
                <span class="s2">&quot;Automask and mask_file parameters are mutually esclusive&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;QI_&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_prefix parameter is undefined. Automatically &quot;</span>
                    <span class="s1">&#39;set to &quot;QI&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is not recognized ...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">+</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s2">&quot;.out&quot;</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="QualityIndex.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.QualityIndex.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QualityIndex</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoclip</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">autoclip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoclip</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">automask</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">automask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">automask</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">autoclip</span> <span class="o">=</span> <span class="n">Undefined</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">automask</span> <span class="o">=</span> <span class="n">Undefined</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">quadrant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadrant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">spearman</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spearman</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="RefitDeoblique"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.RefitDeoblique">[docs]</a><span class="k">class</span> <span class="nc">RefitDeoblique</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * Deoblique dataset.</span>

<span class="sd">    Please, see the complete documentation for the `RefitDeoblique&#39; brick in</span>
<span class="sd">    the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/RefitDeoblique.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="RefitDeoblique.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.RefitDeoblique.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RefitDeoblique</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Input file (a pathlike object or string &quot;</span> <span class="s2">&quot;representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">deoblique_desc</span> <span class="o">=</span> <span class="s2">&quot;Deoblique dataset only if true (boolean).&quot;</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The deobliqued file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;deoblique&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">deoblique_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.Refit&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="RefitDeoblique.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.RefitDeoblique.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RefitDeoblique</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="RefitDeoblique.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.RefitDeoblique.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RefitDeoblique</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">deoblique</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deoblique</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="SkullStrip"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.SkullStrip">[docs]</a><span class="k">class</span> <span class="nc">SkullStrip</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * Extract the brain from surrounding tissue from MRI T1-weighted images.</span>

<span class="sd">    Please, see the complete documentation for the `SkullStrip&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/SkullStrip.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SkullStrip.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.SkullStrip.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SkullStrip</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;A 3D-T1 file to skull-strip (a pathlike object&quot;</span>
            <span class="s2">&quot;or string representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">output_type_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Typecodes of the output image formats (one &quot;</span>
            <span class="s2">&quot;of NIFTI, NIFTI_GZ).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the skull-stripped image file(s) &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The skull-stripped files (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;NIFTI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">output_type_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span><span class="s2">&quot;ss_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.SkullStrip&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SkullStrip.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.SkullStrip.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SkullStrip</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;ss_&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_prefix parameter is undefined. Automatically &quot;</span>
                    <span class="s1">&#39;set to &quot;ss&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is&quot;</span> <span class="s2">&quot; not recognized...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                        <span class="o">+</span> <span class="n">fileName</span>
                        <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                        <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="SkullStrip.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.SkullStrip.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SkullStrip</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outputtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="TShift"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.TShift">[docs]</a><span class="k">class</span> <span class="nc">TShift</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * Slice-time correction of bold images.</span>

<span class="sd">    Please, see the complete documentation for the `TShift&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/TShift.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TShift.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.TShift.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TShift</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Mandatory inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;A bold file to be time-shifted (a pathlike object&quot;</span>
            <span class="s2">&quot;or string representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Optional inputs with default value description</span>
        <span class="n">interpolation_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Interpolation methods (one of ‘Fourier’ or&quot;</span>
            <span class="s2">&quot;‘linear’ or ‘cubic’ or ‘quintic’ or ‘heptic’)&quot;</span>
        <span class="p">)</span>
        <span class="n">output_type_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Typecodes of the output image formats (one &quot;</span>
            <span class="s2">&quot;of NIFTI, NIFTI_GZ).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;output filename (a string).&quot;</span>
        <span class="p">)</span>
        <span class="n">rlt_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Before shifting, remove the mean and linear trend&quot;</span> <span class="s2">&quot;(a boolean)&quot;</span>
        <span class="p">)</span>
        <span class="n">rltplus_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Before shifting, remove the mean and linear trend &quot;</span>
            <span class="s2">&quot;and later put back the mean. (a boolean)&quot;</span>
        <span class="p">)</span>
        <span class="n">slice_encoding_dir_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Direction in which slice_timing is&quot;</span>
            <span class="s2">&quot;specified (default: k).&quot;</span>
            <span class="s2">&quot;If negative,slice_timing is defined&quot;</span>
            <span class="s2">&quot;in reverse order, that is, the first&quot;</span>
            <span class="s2">&quot;entry corresponds to the slice with &quot;</span>
            <span class="s2">&quot;the largest index, and the final entry&quot;</span>
            <span class="s2">&quot;corresponds to slice index zero.&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Optional inputs description</span>
        <span class="n">ignore_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Ignore the first set of points specified.&quot;</span> <span class="s2">&quot;(an integer)&quot;</span>
        <span class="p">)</span>
        <span class="n">slice_timing_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Time offsets from the volume acquisition onset&quot;</span>
            <span class="s2">&quot;for each slice. (a string representing an&quot;</span>
            <span class="s2">&quot;existing file or a list of floats).&quot;</span>
            <span class="s1">&#39;Mutually exclusive with &quot;tpattern&quot; parameters&#39;</span>
        <span class="p">)</span>
        <span class="n">tpattern_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Use specified slice time pattern rather than one in&quot;</span>
            <span class="s2">&quot;header . One of (‘alt+z’ or ‘altplus’ or ‘alt+z2’&quot;</span>
            <span class="s2">&quot;or ‘alt-z’ or ‘altminus’ or ‘alt-z2’ or ‘seq+z’&quot;</span>
            <span class="s2">&quot;or ‘seqplus’ or‘seq-z’ or ‘seqminus’&quot;</span>
            <span class="s1">&#39;Mutually exclusive with &quot;slice_timming&quot; parameters&#39;</span>
        <span class="p">)</span>
        <span class="n">tr_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Manually set the TR. You can add suffix “s” for seconds or&quot;</span>
            <span class="s2">&quot;“ms” for milliseconds (a string)&quot;</span>
        <span class="p">)</span>
        <span class="n">tslice_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Align each slice to time offset of given slice.&quot;</span>
            <span class="s2">&quot;(an integer). Mutually exclusive with tzero parameter.&quot;</span>
        <span class="p">)</span>
        <span class="n">tzero_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot; Align each slice to given time offset&quot;</span>
            <span class="s2">&quot;(a float). Mutually exclusive with tslice parameter.&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The time shifted file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Mandatory inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Optional inputs with default value traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;interpolation&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;Fourier&quot;</span><span class="p">,</span>
                <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;quintic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;heptic&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">interpolation_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;NIFTI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">output_type_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span>
                <span class="s2">&quot;st_corr_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;rlt&quot;</span><span class="p">,</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">rlt_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;rltplus&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">rltplus_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;slice_encoding_dir&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;k&quot;</span><span class="p">,</span>
                <span class="s2">&quot;k-&quot;</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">slice_encoding_dir_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="c1"># Optional inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">ignore_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;slice_timing&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">List</span><span class="p">(</span><span class="n">Float</span><span class="p">()),</span>
                <span class="n">File</span><span class="p">(),</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">slice_timing_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;tpattern&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Enum</span><span class="p">(</span>
                    <span class="s2">&quot;alt+z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;altplus&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;alt+z2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;alt-z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;altminus&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;alt-z2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;seq+z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;seqplus&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;seq-z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;seqminus&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">tpattern_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;tr&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">String</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">tr_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;tslice&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Int</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">tslice_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;tzero&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Float</span><span class="p">(),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">tzero_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.TShift&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TShift.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.TShift.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TShift</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice_timing</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpattern</span> <span class="o">!=</span> <span class="n">Undefined</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Initialisation failed. &quot;</span>
                <span class="s1">&#39;Please, define only &quot;slice_timing&quot; paremeters or &#39;</span>
                <span class="s1">&#39;&quot;tpattern&quot; parameters (set the other as Undefined) ...!&#39;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tslice</span> <span class="o">!=</span> <span class="n">Undefined</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tzero</span> <span class="o">!=</span> <span class="n">Undefined</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Initialisation failed. &quot;</span>
                <span class="s1">&#39;Please, define only &quot;tslice&quot; paremeters or &#39;</span>
                <span class="s1">&#39;&quot;tzero&quot; parameters (set the other as Undefined) ...!&#39;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice_timing</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpattern</span> <span class="o">!=</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;st_corr_&quot;</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;The out_prefix parameter is undefined. &quot;</span>
                        <span class="s1">&#39;Automatically set to &quot;st_corr&quot; ...&#39;</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                    <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is&quot;</span> <span class="s2">&quot; not recognized...!&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                            <span class="o">+</span> <span class="n">fileName</span>
                            <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                            <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                        <span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="TShift.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.TShift.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TShift</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice_timing</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpattern</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outputtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpattern</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">tpattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tpattern</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice_timing</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">slice_timing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice_timing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">slice_encoding_direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slice_encoding_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">rltplus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rltplus</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">interp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tslice</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">tslice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tslice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tzero</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">tzero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tzero</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="TStatMean"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.TStatMean">[docs]</a><span class="k">class</span> <span class="nc">TStatMean</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * Mean of bold images (using AFNI 3dTstat command)</span>

<span class="sd">    Please, see the complete documentation for the `TStatMean&#39; brick</span>
<span class="sd">    in the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/TStatMean.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TStatMean.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.TStatMean.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TStatMean</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;A bold file to be averaged (a pathlike object&quot;</span>
            <span class="s2">&quot;or string  representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">output_type_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Typecodes of the output image formats (one &quot;</span>
            <span class="s2">&quot;of NIFTI, NIFTI_GZ).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the skull-stripped image file(s) &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Outputs description</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The time shifted file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;NIFTI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">output_type_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span><span class="s2">&quot;mean_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.TStat&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TStatMean.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.TStatMean.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TStatMean</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;mean_&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_prefix parameter is undefined. Automatically &quot;</span>
                    <span class="s1">&#39;set to &quot;mean&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is&quot;</span> <span class="s2">&quot; not recognized...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                        <span class="o">+</span> <span class="n">fileName</span>
                        <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                        <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="TStatMean.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.TStatMean.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TStatMean</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;-mean&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outputtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>


<div class="viewcode-block" id="Volreg"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Volreg">[docs]</a><span class="k">class</span> <span class="nc">Volreg</span><span class="p">(</span><span class="n">ProcessMIA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * Register an input volume to a base volume using AFNI 3dvolreg command.</span>

<span class="sd">    Please, see the complete documentation for the `Volreg&#39; brick in</span>
<span class="sd">    the populse.mia_processes website</span>
<span class="sd">    &lt;https://populse.github.io/mia_processes/html/documentation/bricks/preprocess/afni/Volreg.html&gt;`_</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Volreg.__init__"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Volreg.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the attributes initialisation/instantiation.</span>

<span class="sd">        The input and output plugs are defined here. The special</span>
<span class="sd">        &#39;self.requirement&#39; attribute (optional) is used to define the</span>
<span class="sd">        third-party products necessary for the running of the brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialisation of the objects needed for the launch of the brick</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Volreg</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Third party softwares required for the execution of the brick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requirement</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;nipype&quot;</span><span class="p">]</span>

        <span class="c1"># Mandatory inputs description</span>
        <span class="n">in_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Input (a pathlike object or &quot;</span> <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Optional inputs with default value description</span>
        <span class="n">copyorigin_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Copy base file origin coords to output&quot;</span> <span class="s2">&quot;(a boolean)&quot;</span>
        <span class="p">)</span>
        <span class="n">interpolation_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Spatial interpolation methods (Either &quot;</span>
            <span class="s2">&quot;‘Fourier’ or ‘cubic’ or ‘heptic’ &quot;</span>
            <span class="s2">&quot;or ‘quintic’ or ‘linear’. Default is heptic)&quot;</span>
        <span class="p">)</span>
        <span class="n">output_type_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Typecodes of the output image formats (one &quot;</span>
            <span class="s2">&quot;of NIFTI, NIFTI_GZ).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_prefix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Specify the string to be prepended to the &quot;</span>
            <span class="s2">&quot;filenames of the registered image file(s) &quot;</span>
            <span class="s2">&quot;(a string).&quot;</span>
        <span class="p">)</span>
        <span class="n">save_md1d_file_desc</span> <span class="o">=</span> <span class="s2">&quot;Save md1d file (a boolean)&quot;</span>
        <span class="n">save_oned_matrix_desc</span> <span class="o">=</span> <span class="s2">&quot;Save oned matrix (a boolean)&quot;</span>
        <span class="n">timeshift_desc</span> <span class="o">=</span> <span class="s2">&quot;Time shift to mean slice time offset.&quot;</span>
        <span class="n">twopass_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Do two passes of the registration algorithm:&quot;</span>
            <span class="s2">&quot;(1) with smoothed base and data bricks, with linear&quot;</span>
            <span class="s2">&quot; interpolation, to get a crude alignment, then&quot;</span>
            <span class="s2">&quot;(2) with the input base and data bricks, to get a &quot;</span>
            <span class="s2">&quot;fine alignment.&quot;</span>
            <span class="s2">&quot;This method is useful when aligning high-resolution&quot;</span>
            <span class="s2">&quot;datasets that may need to be moved more than&quot;</span>
            <span class="s2">&quot; a few voxels to be aligned. (a boolean).&quot;</span>
        <span class="p">)</span>
        <span class="n">zpad_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Zeropad around the edges by ‘n’ voxels during rotations &quot;</span>
            <span class="s2">&quot;(an integer).&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Optional inputs description</span>
        <span class="n">in_weight_volume_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Weights for each voxel specified by a file&quot;</span>
            <span class="s2">&quot;with an optional volume number &quot;</span>
            <span class="s2">&quot;(defaults to 0). A a tuple of the form:&quot;</span>
            <span class="s2">&quot;(a pathlike object or string representing&quot;</span>
            <span class="s2">&quot; an existing file, an integer)&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Outputs description</span>
        <span class="n">md1d_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Max displacement outputfile (a pathlike object&quot;</span>
            <span class="s2">&quot;or a  string representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">oned_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The movement parameters file (a pathlike object&quot;</span>
            <span class="s2">&quot;or a  string representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">oned_matrix_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The transformation matrix (a pathlike object&quot;</span>
            <span class="s2">&quot;or a  string representing a file).&quot;</span>
        <span class="p">)</span>
        <span class="n">out_file_desc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The registered file (a pathlike object or a &quot;</span>
            <span class="s2">&quot;string representing a file).&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Mandatory inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">in_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Optional inputs with default value traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;copyorigin&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">copyorigin_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;interpolation&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;heptic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Fourier&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cubic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;quintic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="s2">&quot;heptic&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">interpolation_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">Enum</span><span class="p">(</span>
                <span class="s2">&quot;NIFTI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;NIFTI_GZ&quot;</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">output_type_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;out_prefix&quot;</span><span class="p">,</span>
            <span class="n">String</span><span class="p">(</span><span class="s2">&quot;reg_&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_prefix_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;save_oned_matrix&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span>
                <span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">save_oned_matrix_desc</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;save_md1d_file&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">save_md1d_file_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;timeshift&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">timeshift_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;twopass&quot;</span><span class="p">,</span>
            <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">twopass_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;zpad&quot;</span><span class="p">,</span> <span class="n">Int</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">zpad_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Optional inputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;in_weight_volume&quot;</span><span class="p">,</span>
            <span class="n">Either</span><span class="p">(</span>
                <span class="n">Undefined</span><span class="p">,</span>
                <span class="n">Tuple</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="n">Int</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                <span class="n">default</span><span class="o">=</span><span class="n">Undefined</span><span class="p">,</span>
                <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">desc</span><span class="o">=</span><span class="n">in_weight_volume_desc</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Outputs traits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;md1d_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">md1d_file_desc</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;oned_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">oned_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span>
            <span class="s2">&quot;oned_matrix&quot;</span><span class="p">,</span>
            <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">oned_matrix_desc</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_trait</span><span class="p">(</span><span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">File</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">out_file_desc</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_default_traits</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_process</span><span class="p">(</span><span class="s2">&quot;nipype.interfaces.afni.Volreg&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Volreg.list_outputs"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Volreg.list_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">list_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_plugged</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the initialisation step of the brick.</span>

<span class="sd">        The main objective of this method is to produce the outputs of the</span>
<span class="sd">        bricks (self.outputs) and the associated tags (self.inheritance_dic),</span>
<span class="sd">        if defined here. In order not to include an output in the database,</span>
<span class="sd">        this output must be a value of the optional key &#39;notInDb&#39; of the</span>
<span class="sd">        self.outputs dictionary. To work properly this method must return</span>
<span class="sd">        self.make_initResult() object.</span>

<span class="sd">        :param is_plugged: the state, linked or not, of the plugs.</span>
<span class="sd">        :returns: a dictionary with requirement, outputs and inheritance_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using the inheritance to ProcessMIA class, list_outputs method</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Volreg</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">list_outputs</span><span class="p">()</span>

        <span class="c1"># Outputs definition and tags inheritance (optional)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">==</span> <span class="n">Undefined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="s2">&quot;reg_&quot;</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;The out_prefix parameter is undefined. Automatically &quot;</span>
                    <span class="s1">&#39;set to &quot;reg&quot; ...&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">:</span>
                <span class="n">valid_ext</span><span class="p">,</span> <span class="n">in_ext</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">checkFileExt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_file</span><span class="p">,</span> <span class="n">EXT</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_ext</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The input image format is&quot;</span> <span class="s2">&quot; not recognized...!&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                        <span class="o">+</span> <span class="n">fileName</span>
                        <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                        <span class="o">+</span> <span class="n">EXT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">output_type</span><span class="p">],</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;oned_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">+</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s2">&quot;_oned.txt&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;out_file&quot;</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;oned_file&quot;</span><span class="p">]</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_oned_matrix</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;oned_matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>
                            <span class="o">+</span> <span class="n">fileName</span>
                            <span class="o">+</span> <span class="s2">&quot;_oned_matrix.aff12.1D&quot;</span><span class="p">,</span>
                        <span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;oned_matrix&quot;</span><span class="p">]</span>
                        <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_md1d_file</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;md1d_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">+</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s2">&quot;_md.1D&quot;</span><span class="p">,</span>
                        <span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">inheritance_dict</span><span class="p">[</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;md1d_file&quot;</span><span class="p">]</span>
                        <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No output_directory was found...!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># Return the requirement, outputs and inheritance_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_initResult</span><span class="p">()</span></div>

<div class="viewcode-block" id="Volreg.run_process_mia"><a class="viewcode-back" href="../../../../../mia_processes.bricks.preprocess.afni.html#mia_processes.bricks.preprocess.afni.processes.Volreg.run_process_mia">[docs]</a>    <span class="k">def</span> <span class="nf">run_process_mia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dedicated to the process launch step of the brick.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Volreg</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_process_mia</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outputtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">interp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">twopass</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;-twopass&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zpad</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">zpad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zpad</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">copyorigin</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">copyorigin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copyorigin</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_weight_volume</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">in_weight_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_weight_volume</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">oned_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oned_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_oned_matrix</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">oned_matrix_save</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oned_matrix</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_md1d_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">md1d_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">md1d_file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">out_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_prefix</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">configuration_dict</span><span class="o">=</span><span class="p">{})</span></div></div>
</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../../../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, populse.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>