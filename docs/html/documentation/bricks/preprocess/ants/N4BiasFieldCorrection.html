
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>N4BiasFieldCorrection brick &#8212; mia_processes 2.2.1-dev+416c37b documentation</title>
    <link rel="stylesheet" href="../../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../../../index.html">
          <span>mia_processes 2.2.1-dev+416c37b documentation</span></a></h1>
        <h2 class="heading"><span>N4BiasFieldCorrection brick</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <div class="toctree-wrapper compound">
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 35%" />
<col style="width: 40%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="../../../../index.html">Home</a></p></td>
<td><p><a class="reference external" href="../../../documentation.html">Documentation</a></p></td>
<td><p><a class="reference external" href="https://github.com/populse/mia_processes">GitHub</a></p></td>
</tr>
</tbody>
</table>
<div class="section" id="n4biasfieldcorrection-brick">
<h1>N4BiasFieldCorrection brick<a class="headerlink" href="#n4biasfieldcorrection-brick" title="Permalink to this headline">¶</a></h1>
<p>Bias field correction using ANTs N4BiasFieldCorrection</p>
<p>N4 is a variant of the popular N3 (nonparameteric nonuniform normalization) retrospective bias correction algorithm.
Based on the assumption that the corruption of the low frequency bias field can be modeled as a convolution of the intensity histogram by a Gaussian,
the basic algorithmic protocol is to iterate between deconvolving the intensity histogram by a Gaussian, remapping the intensities,
and then spatially smoothing this result by a B-spline modeling of the bias field itself</p>
<hr class="docutils" />
<p><strong>Mandatory inputs parameters:</strong></p>
<ul>
<li><dl>
<dt><em>in_file</em> (a string representing an existing file)</dt><dd><p>A image file (2D, 3D or 4D) to correct (valid extensions: [.nii, .nii.gz]).
If thera are negative values or values close to zero, they are processed prior to correction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="s1">&#39;/home/username/data/raw_data/T1w.nii&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<p><strong>Optional inputs parameters with a default value:</strong></p>
<ul>
<li><dl>
<dt><em>copy_header</em> (a boolean, optionnal, default value is True)</dt><dd><p>Copy headers of the original image into the output (corrected) file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="kc">True</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>dimension</em> (2 or 3 or 4, optional, default value is 3)</dt><dd><p>Image dimension (2 or 3 or 4).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="mi">3</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>out_prefix</em> (a string, optional, default value is ‘’n4c’)</dt><dd><p>Prefix of the output image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="s1">&#39;n4c_&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>rescale_intensities</em> (a boolean, optionnal, default value is True)</dt><dd><p>Rescales to the [min,max] range of theoriginal image intensities within the user-specified mask.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="kc">True</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>save_bias</em> (a boolean, optionnal, default value is True)</dt><dd><p>Save the estimated bias in a file .</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="kc">True</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<p><strong>Optional inputs parameters:</strong></p>
<ul>
<li><dl>
<dt><em>bspline_fitting_distance</em> (a float, optional)</dt><dd><p>Set bspline fitting distance.
Default is Undefined (ie parameter not used).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="mf">300.0</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>bspline_order</em> (an integer, optional)</dt><dd><p>Set bspline order. Require bspline_fitting_distance parameters.
Default is Undefined (ie parameter not used).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="mi">5</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>convergence_threshold</em> (a float, optional)</dt><dd><p>Set convergence threshold.
Require n_iterations parameters.
Default is Undefined (ie parameter not used).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="mf">1e-6</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>histogram_sharpening</em> (a tuple of the form: (a float, a float, an integer), optional)</dt><dd><p>Three-values tuple of histogram sharpening parameters (FWHM, wienerNose, numberOfHistogramBins).
These options describe the histogram sharpening parameters, i.e. the deconvolution step parameters described in the original N3 algorithm.
Note that the default values have been shown to work fairly well.
Default is Undefined (ie parameter not used).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="p">(</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>mask_image</em> (a string representing an existing file, optional)</dt><dd><p>Image to specify region to perform final bias correction in.
Default is Undefined (ie parameter not used).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="s1">&#39;/home/username/data/derived_data/T1w_mask.nii&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>n_iterations</em> (a list of integer, optional)</dt><dd><p>Set number of iterations.
Default is Undefined (ie parameter not used).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>shrink_factor</em> (an integer, optional)</dt><dd><p>Shrink factor.
Default is Undefined (ie parameter not used).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="mi">3</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>weight_image</em> (a string representing an existing file, optional)</dt><dd><p>Image for relative weighting (e.g. probability map of the white matter) of voxels during the B-spline fitting.
Default is Undefined (ie parameter not used).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="s1">&#39;/home/username/data/derived_data/T1w_pve_0.nii&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<p><strong>Outputs parameters:</strong></p>
<ul>
<li><dl>
<dt><em>bias_image</em> (a strings representing a file)</dt><dd><p>Estimated bias (extensions: [.nii, .nii.gz]).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="s1">&#39;/home/username/data/derived_data/T1w_bias.nii&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>negative_values</em> (a strings representing a file)</dt><dd><p>True if negative values are present in the input image. False otherwise.
If thera are negative values or values close to zero, they are processed prior to correction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="kc">False</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><em>out_file</em> (a strings representing a file)</dt><dd><p>Out image (extensions: [.nii, .nii.gz]).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span><span class="o">.</span> <span class="s1">&#39;/home/username/data/derived_data/n4c_T1w.nii&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<hr class="docutils" />
<p>Usefull links:</p>
<p><a class="reference external" href="https://nipype.readthedocs.io/en/latest/api/generated/nipype.interfaces.ants.html#n4biasfieldcorrection">ANTS N4BiasFieldCorrection - nipype</a></p>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, populse.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>